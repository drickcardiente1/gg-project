{% extends 'admin-base.html' %}
{% load static %}

{% block styles %}
<link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.0.0/css/buttons.dataTables.min.css">
{% endblock %}

{% block tittle %} Rooms {% endblock %}


{% block navbar %}
<li class="nav-item">
    <a class="nav-link text-white opacity-10" href="/admin/dashboard" onclick="load2()">
        <div class="icon icon-shape icon-sm border-radius-md text-center d-flex align-items-center justify-content-center">
            <svg width="16px" height="16px" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M3 4C3 3.44772 3.44772 3 4 3H16C16.5523 3 17 3.44772 17 4V6C17 6.55228 16.5523 7 16 7H4C3.44772 7 3 6.55228 3 6V4Z"
                    class="color-background"></path>
                <path
                    d="M3 10C3 9.44771 3.44772 9 4 9H10C10.5523 9 11 9.44771 11 10V16C11 16.5523 10.5523 17 10 17H4C3.44772 17 3 16.5523 3 16V10Z"
                    class="color-background"></path>
                <path
                    d="M14 9C13.4477 9 13 9.44771 13 10V16C13 16.5523 13.4477 17 14 17H16C16.5523 17 17 16.5523 17 16V10C17 9.44771 16.5523 9 16 9H14Z"
                    class="color-background"></path>
            </svg>
        </div>
        <span class="nav-link-text ms-2">Dashboard</span>
    </a>
</li>
<li class="nav-item">
    <a class="nav-link text-white opacity-10" href="/admin/users" onclick="load2()">
        <div class="icon icon-shape icon-sm border-radius-md text-center d-flex align-items-center justify-content-center">
            <svg width="20" height="15" viewBox="0 0 20 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M9 3.5C9 5.43299 7.43299 7 5.5 7C3.56701 7 2 5.43299 2 3.5C2 1.56701 3.56701 0 5.5 0C7.43299 0 9 1.56701 9 3.5Z"
                    fill="white" class="color-background"></path>
                <path
                    d="M18 3.5C18 5.43299 16.4331 7 14.5 7C12.5669 7 11 5.43299 11 3.5C11 1.56701 12.5669 0 14.5 0C16.4331 0 18 1.56701 18 3.5Z"
                    fill="white" class="color-background"></path>
                <path
                    d="M13.5245 15C13.5744 14.619 13.6002 14.2294 13.6002 13.8333C13.6002 11.9256 13.0021 10.1707 12 8.78062C12.7844 8.28408 13.6953 8 14.6668 8C17.6122 8 20 10.6117 20 13.8333V15H13.5245Z"
                    fill="white" class="color-background"></path>
                <path d="M5.5 8C8.53756 8 11 10.6117 11 13.8333V15H0V13.8333C0 10.6117 2.46244 8 5.5 8Z" 
                fill="white" class="color-background"></path>
            </svg>
        </div>
        <span class="nav-link-text ms-2">Users</span>
    </a>
</li>
<li class="nav-item">
    <a class="nav-link text-white opacity-10 active" href="javascript:;">
        <div class="icon icon-shape icon-sm border-radius-md text-center d-flex align-items-center justify-content-center">
            <svg width="20" height="21" viewBox="0 0 20 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M19.5703 4.13281L10.4297 0.617188C10.2734 0.539062 10.1172 0.539062 10 0.539062C9.84375 0.539062 9.6875 0.539062 9.53125 0.617188L0.390625 4.13281C0.15625 4.21094 0 4.44531 0 4.71875V6.125C0 6.47656 0.273438 6.75 0.625 6.75H19.375C19.6875 6.75 20 6.47656 20 6.125V4.71875C20 4.44531 19.8047 4.21094 19.5703 4.13281ZM2.5 8V14.25H1.875C1.52344 14.25 1.25 14.5625 1.25 14.875V16.75H18.75V14.875C18.75 14.5625 18.4375 14.25 18.125 14.25H17.5V8H15V14.25H11.25V8H8.75V14.25H5V8H2.5ZM19.375 18H0.625C0.273438 18 0 18.3125 0 18.625V19.875C0 20.2266 0.273438 20.5 0.625 20.5H19.375C19.6875 20.5 20 20.2266 20 19.875V18.625C20 18.3125 19.6875 18 19.375 18Z"
                    fill="white" class="color-background"></path>
            </svg>
        </div>
        <span class="nav-link-text ms-2">Rooms</span>
    </a>
</li>
<li class="nav-item">
    <a class="nav-link text-white opacity-10" href="/admin/bookings" onclick="load2()">
        <div class="icon icon-shape icon-sm border-radius-md text-center d-flex align-items-center justify-content-center">
            <svg width="18" height="21" viewBox="0 0 18 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M0.71875 8C0.445312 8 0.25 8.23438 0.25 8.46875V18.625C0.25 19.6797 1.07031 20.5 2.125 20.5H15.875C16.8906 20.5 17.75 19.6797 17.75 18.625V8.46875C17.75 8.23438 17.5156 8 17.2812 8H0.71875ZM17.75 6.28125V4.875C17.75 3.85938 16.8906 3 15.875 3H14V0.96875C14 0.734375 13.7656 0.5 13.5312 0.5H11.9688C11.6953 0.5 11.5 0.734375 11.5 0.96875V3H6.5V0.96875C6.5 0.734375 6.26562 0.5 6.03125 0.5H4.46875C4.19531 0.5 4 0.734375 4 0.96875V3H2.125C1.07031 3 0.25 3.85938 0.25 4.875V6.28125C0.25 6.55469 0.445312 6.75 0.71875 6.75H17.2812C17.5156 6.75 17.75 6.55469 17.75 6.28125Z"
                    fill="white" class="color-background"></path>
            </svg>
        </div>
        <span class="nav-link-text ms-2">Bookings</span>
    </a>
</li>
{% endblock %}

{% block tag %}ROOMS{% endblock %}

{% block profile_link %}href="/admin/my-profile/"{% endblock %}
{% block message_link %}href="{% url 'all_notifications' %}"{% endblock %}

{% block content %}
<div class="px-5 py-4 container-fluid">
    <div class="mt-4 row">
        <div class="col-12">
            <div class="card">
                <img src="https://res.cloudinary.com/devqjzqxb/image/upload/v1716026141/design3/vlvdil4e367jn5ccvv3j.png" alt="pattern-lines"
                    class="top-0 rounded-2 position-absolute start-0 w-100 h-100">
                <div class="px-4 bg-cover card-body z-index-1">
                    <div class="row">
                        <div class="col-lg-8 col-12">
                            <h3 class="text-white">Rooms list ðŸ”¥</h3>
                            <p class="mb-4 text-white">See information about all Rooms.</p>
                            <a class="mb-1 btn btn-dark" href="add/">
                                <i class="fas fa-plus me-1" aria-hidden="true"></i>
                                New Room
                            </a>
                        </div>
                        <div class="text-end col-lg-4 col-12">
                            <img class="w-35 ms-auto me-5 d-none d-md-block" src="https://res.cloudinary.com/devqjzqxb/image/upload/v1716026424/design3/qyyqgsqahb25arbvd89p.png"
                                alt="cube image">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="mt-4 row">
        <div class="col-12">
            <div class="card">
                <div class="pb-0 card-header">
                    <div class="row">
                        <div class="col-6">
                            <h5 class>Rooms Table</h5>
                        </div>
                    </div>
                </div>
                <div class="table-responsive">
                    <table class="table table-flush" id="rooms">
                        <thead>
                            <tr>
                                <th class="text-xs text-secondary font-weight-bolder opacity-7">ID</th>
                                <th class="text-xs text-secondary font-weight-bolder opacity-7">ROOM NAME</th>
                                <th class="text-xs text-secondary font-weight-bolder opacity-7">DAILY RATE</th>
                                <th class="text-xs text-secondary font-weight-bolder opacity-7">MAX OCCUPANCY</th>
                                <th class="text-xs text-secondary font-weight-bolder opacity-7">DATE UPDATED</th>
                                <th class="text-xs text-secondary font-weight-bolder opacity-7">DATE CREATED</th>
                                <th class="text-xs text-secondary font-weight-bolder opacity-7"></th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for room_item in room_data %}
                            <tr class="bg-dark">
                                <td class="text-sm font-weight-normal text-center">
                                    <span class="text-secondary font-weight-normal">{{ room_item.room.id }}</span>
                                </td>
                                <td class="text-sm font-weight-normal">
                                    <div class="d-flex">
                                        <div class="d-flex align-items-center justify-content-center">
                                            {% if room_item.default_image %}
                                            <img src="{{ room_item.default_image }}" class="avatar avatar-sm rounded-circle me-3">
                                            {% else %}
                                            <img src="https://res.cloudinary.com/devqjzqxb/image/upload/v1715779076/design3/pcqcgzowqxqbnc71cbz2.webp" class="avatar avatar-sm rounded-circle me-3">
                                            {% endif %}
                                        </div>
                                        <div class="d-flex flex-column justify-content-center">
                                            <h6 class="mb-0 text-dark">{{ room_item.room.room_name }}</h6>
                                            <!-- <p class="mb-0 text-sm text-secondary">
                                                <a>{{ user.email }}</a>
                                            </p> -->
                                        </div>
                                    </div>
                                </td>
                                <td class="text-sm font-weight-normal">
                                    <h6 class="mb-0 text-dark">{{ room_item.room.daily_rate }}</h6>
                                </td>
                                <td class="text-sm font-weight-normal">
                                    <h6 class="mb-0 text-dark">{{ room_item.room.max_occupancy }}</h6>
                                </td>
                                <td class="text-sm font-weight-normal">
                                    <span class="text-secondary font-weight-normal">{{ room_item.room.date_created|date:"d/m/Y" }}</span>
                                </td>
                                <td class="text-sm font-weight-normal">
                                    <span class="text-secondary font-weight-normal">{{ room_item.room.date_updated|date:"d/m/Y" }}</span>
                                </td>
                                <td class="text-sm text-end font-weight-normal text-center" style="vertical-align: middle; text-align: center;">
                                    <a href="{% url 'edit_room' room_item.room.id %}" onclick="load2()" class="me-3 mx-4 mt-2">
                                        <i class="fas fa-user-edit text-info"></i>
                                    </a>
                                    <a href="{% url 'room_remove' room_item.room.id %}" onclick="load2()" class="me-3 mx-4 mt-2">
                                        <i class="fas fa-trash text-danger"></i>
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                            <!-- {% for image_url in room_item.image_urls %}
                            <li><img src="{{ image_url }}" alt="Room Image"></li>
                        {% endfor %} -->
                        </tbody>
                        <tfoot>
                            <tr>
                                <th class="text-xs text-secondary font-weight-bolder opacity-7">ID</th>
                                <th class="text-xs text-secondary font-weight-bolder opacity-7">ROOM NAME</th>
                                <th class="text-xs text-secondary font-weight-bolder opacity-7">DAILY RATE</th>
                                <th class="text-xs text-secondary font-weight-bolder opacity-7">MAX OCCUPANCY</th>
                                <th class="text-xs text-secondary font-weight-bolder opacity-7">DATE UPDATED</th>
                                <th class="text-xs text-secondary font-weight-bolder opacity-7">DATE CREATED</th>
                                <th class="text-xs text-secondary font-weight-bolder opacity-7"></th>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <footer class="pt-5 pb-1 mt-auto footer">
        <div class="container">
            <div class="row align-items-center justify-content-lg-between">
                <div class="col-lg-6">
                    <div class="text-sm text-center copyright text-md-start">
                        Copyright Â© 2024 <a class="text-sm text-body ms-1">Hotel Reservation</a>
                    </div>
                </div>
                <div class="col-lg-6">
                    <ul class="text-white nav nav-footer justify-content-center justify-content-lg-end">
                        <li class="nav-item">
                            <a class="text-sm nav-link text-body" target="_blank">By Aileen Guigue</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>
</div>
{% endblock %}


{% block script %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.0/js/dataTables.buttons.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.70/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.70/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.0/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.0/js/buttons.print.min.js"></script>
<!-- DataTables initialization script -->
<script>
    $(document).ready(function() {
    var table = $('#rooms').DataTable({
        "paging": true,
        "lengthMenu": [5, 10, 25, 50],
        "searching": true,
        "ordering": true,
        "info": true,
        "autoWidth": false,
        "responsive": true,
        "language": {
            "paginate": {
                "previous": "&laquo; Previous",
                "next": "Next &raquo;"
            }
        },
        "drawCallback": function() {
            $('#rooms_paginate').find('.paginate_button').addClass('btn btn-sm btn-outline-dark');
            $('#rooms_paginate').find('.paginate_button.current').addClass('btn btn-sm btn-dark');
        },
        "columnDefs": [
            {
                "targets": -1,  // Target the last column
                "orderable": false  // Disable sorting for the last column
            }
        ]
    });
});
</script>
{% endblock %}